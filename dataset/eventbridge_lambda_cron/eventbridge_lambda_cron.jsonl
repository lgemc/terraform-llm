{"instance_id": "terraform-aws-eventbridge-001", "problem_statement": "Create an EventBridge (CloudWatch Events) rule that triggers a Lambda function every day at 7:00 UTC using a cron expression. The Lambda function should have proper IAM role with basic execution permissions. Include the event target, Lambda permission for EventBridge, and IAM role policy attachment.", "difficulty": "medium", "tags": ["eventbridge", "lambda", "cron", "scheduled", "serverless", "aws"], "provider": "aws", "region": "us-east-1", "expected_resources": {"aws_cloudwatch_event_rule": 1, "aws_cloudwatch_event_target": 1, "aws_lambda_function": 1, "aws_lambda_permission": 1, "aws_iam_role": 1, "aws_iam_role_policy_attachment": 1}, "required_outputs": ["rule_arn", "lambda_arn"], "validation_script": "dataset/eventbridge_lambda_cron/validation.py", "gold_solution": {"main.tf": "data \"aws_iam_policy_document\" \"cron_assume_role\" {\n  statement {\n    actions = [\"sts:AssumeRole\"]\n    principals {\n      type        = \"Service\"\n      identifiers = [\"lambda.amazonaws.com\", \"events.amazonaws.com\"]\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"cron\" {\n  name               = \"cron_assume_role\"\n  assume_role_policy = data.aws_iam_policy_document.cron_assume_role.json\n}\n\nresource \"aws_iam_role_policy_attachment\" \"cron\" {\n  role       = aws_iam_role.cron.name\n  policy_arn = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n}\n\nresource \"aws_cloudwatch_event_rule\" \"cron\" {\n  schedule_expression = \"cron(0 7 * * ? *)\"\n  role_arn            = aws_iam_role.cron.arn\n}\n\nresource \"aws_cloudwatch_event_target\" \"cron\" {\n  rule = aws_cloudwatch_event_rule.cron.name\n  arn  = aws_lambda_function.cron.arn\n}\n\ndata \"archive_file\" \"lambda_func\" {\n  type        = \"zip\"\n  source_file = \"${path.module}/lambda_code/handler.py\"\n  output_path = \"${path.module}/lambda_code/handler.zip\"\n}\n\nresource \"aws_lambda_function\" \"cron\" {\n  function_name    = \"cron-lambda-function\"\n  role             = aws_iam_role.cron.arn\n  filename         = data.archive_file.lambda_func.output_path\n  source_code_hash = data.archive_file.lambda_func.output_base64sha256\n  handler          = \"handler.handler\"\n  runtime          = \"python3.12\"\n}\n\nresource \"aws_lambda_permission\" \"cron\" {\n  function_name = aws_lambda_function.cron.function_name\n  action        = \"lambda:InvokeFunction\"\n  principal     = \"events.amazonaws.com\"\n  source_arn    = aws_cloudwatch_event_rule.cron.arn\n}\n\noutput \"rule_arn\" {\n  value = aws_cloudwatch_event_rule.cron.arn\n}\n\noutput \"lambda_arn\" {\n  value = aws_lambda_function.cron.arn\n}\n"}, "hints": ["Use schedule_expression = 'cron(0 7 * * ? *)' for daily at 7 UTC", "The event rule needs role_arn for the IAM role", "Event target links the rule to the Lambda function ARN", "Lambda permission must allow events.amazonaws.com principal", "IAM role needs AssumeRole for both lambda and events services"], "metadata": {"estimated_cost": "$0.00", "deployment_time_seconds": 120, "cleanup_required": true, "created_at": "2025-02-25", "author": "iac-eval"}}
