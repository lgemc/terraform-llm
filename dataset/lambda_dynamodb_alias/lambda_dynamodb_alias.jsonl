{"instance_id": "terraform-aws-lambda-alias-001", "problem_statement": "Create a Lambda function with a DynamoDB table for data storage. The Lambda should have an IAM role with a policy granting DynamoDB CRUD permissions. Create a Lambda alias pointing to the $LATEST version. The DynamoDB table should have streams enabled with NEW_AND_OLD_IMAGES view type.", "difficulty": "medium", "tags": ["lambda", "dynamodb", "iam", "alias", "serverless", "aws"], "provider": "aws", "region": "us-east-1", "expected_resources": {"aws_lambda_function": 1, "aws_lambda_alias": 1, "aws_dynamodb_table": 1, "aws_iam_role": 1, "aws_iam_policy": 1, "aws_iam_role_policy_attachment": 1}, "required_outputs": ["lambda_arn", "alias_arn", "dynamodb_table_name"], "validation_script": "dataset/lambda_dynamodb_alias/validation.py", "gold_solution": {"main.tf": "resource \"aws_dynamodb_table\" \"example_table\" {\n  name             = \"example_table\"\n  hash_key         = \"id\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"id\"\n    type = \"S\"\n  }\n}\n\ndata \"aws_iam_policy_document\" \"assume_role\" {\n  statement {\n    effect = \"Allow\"\n    principals {\n      type        = \"Service\"\n      identifiers = [\"lambda.amazonaws.com\"]\n    }\n    actions = [\"sts:AssumeRole\"]\n  }\n}\n\nresource \"aws_iam_role\" \"iam_for_lambda\" {\n  name               = \"iam_for_lambda\"\n  assume_role_policy = data.aws_iam_policy_document.assume_role.json\n}\n\nresource \"aws_iam_policy\" \"lambda_dynamodb_policy\" {\n  name = \"lambda-dynamodb-policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"dynamodb:GetItem\",\n          \"dynamodb:PutItem\",\n          \"dynamodb:UpdateItem\",\n          \"dynamodb:DeleteItem\"\n        ]\n        Effect   = \"Allow\"\n        Resource = aws_dynamodb_table.example_table.arn\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"lambda_policy_attach\" {\n  role       = aws_iam_role.iam_for_lambda.name\n  policy_arn = aws_iam_policy.lambda_dynamodb_policy.arn\n}\n\ndata \"archive_file\" \"lambda\" {\n  type        = \"zip\"\n  source_file = \"${path.module}/lambda_code/app.js\"\n  output_path = \"${path.module}/lambda_code/app.zip\"\n}\n\nresource \"aws_lambda_function\" \"example_lambda\" {\n  filename         = data.archive_file.lambda.output_path\n  function_name    = \"lambda_app_function\"\n  source_code_hash = data.archive_file.lambda.output_base64sha256\n  role             = aws_iam_role.iam_for_lambda.arn\n  handler          = \"app.handler\"\n  runtime          = \"nodejs18.x\"\n}\n\nresource \"aws_lambda_alias\" \"test_lambda_alias\" {\n  name             = \"my_alias\"\n  description      = \"a sample description\"\n  function_name    = aws_lambda_function.example_lambda.arn\n  function_version = \"$LATEST\"\n}\n\noutput \"lambda_arn\" {\n  value = aws_lambda_function.example_lambda.arn\n}\n\noutput \"alias_arn\" {\n  value = aws_lambda_alias.test_lambda_alias.arn\n}\n\noutput \"dynamodb_table_name\" {\n  value = aws_dynamodb_table.example_table.name\n}\n"}, "hints": ["DynamoDB table needs stream_enabled = true and stream_view_type = NEW_AND_OLD_IMAGES", "Lambda needs IAM role with AssumeRole for lambda.amazonaws.com", "Create a separate IAM policy for DynamoDB CRUD operations", "Lambda alias needs name, function_name, and function_version = $LATEST", "Use data archive_file to zip the Lambda code"], "metadata": {"estimated_cost": "$0.00", "deployment_time_seconds": 120, "cleanup_required": true, "created_at": "2025-02-25", "author": "iac-eval"}}
